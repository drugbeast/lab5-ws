# Отчет

## Описание

В этой работе была реализована двухэтапная аутентификация. Двухэтапная она потому, что пользователю, для того, чтобы полноценно войти в систему (получить access_token), нужно ввести код из письма, которое отправляется ему на электронную почту gmail. В работе использовались следующие технолгии: bcryptjs, body-parser, dotenv, express, jsonwebtoken, nodemailer, pg (СУБД postgres).

## Эндпоинты

+ */register* - регистрация пользователя
+ */login* - авторизация пользователя. Может отослать пользователю сообщение на электронную почту gmail
+ */verify-2fa* - эндпоинт для подтверждения правильности кода, пришедшего на электронную почту и первой генерации access_token и refresh_token
+ */refresh-token* - эндпоинт для генерации нового access_token, если у старого истек срок жизни.
+ */logout* - эндпоинт для выхода из системы
+ */home* - некое подобие "домашней" страницы. Возвращает разные ответы в зависимости от того, авторизован ли пользователь или нет.

## Инструкция по запуску

+ `npm start` - для запуска приложения
+ `psql -U postgres lab4` - для подключения к базе данных lab4

Перед запуском следует почистить базу данных, удалив таблицы командой `DROP TABLE IF EXISTS table_name`. В БД присутсвуют две таблицы: users и blacklisted_tokens. Команда `\i db.sql` используется для запуска SQL-скрипта и создания таблиц в БД lab4. Перед запуском следует выключить VPN.